<%= render layout: 'index_table' do %>
  <% @products.group_by(&:product_taxon).each do |taxon, products| %>
    <tr>
      <td rowspan="<%= products.size + 1 %>">
      <% if taxon %>
        <p><%= taxon.name %></p>
        <p class="has-text-grey"><%= taxon.scene&.title %></p>
      <% end %>
      </td>
    </tr>
    <%= render partial: 'index_tbody', layout: 'index_tr', collection: products, as: :model %>
  <% end %>
<% end %>

<%= paginate @products %>
